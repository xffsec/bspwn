### recon scripts
function smap(){
    sudo nmap -sS -p- --open -n -Pn --min-rate=5000 --disable-arp-ping --stats-every=5s -oA tcp-all "$1"
}

function umap(){
    sudo nmap -sU -F --open -n -Pn --min-rate=5000 --disable-arp-ping --stats-every=5s -oA udp-all "$1"
}

function xps(){
    if [ -z "$1" ]
    then
        echo "Provide a file
usage: xps <filename>"
    else
        ip_Oaddress=$( grep --color=never -oP '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}' $1 | sort -u  )
        ports_Ofile=$( grep --color=never -oP '\d{1,5}/open' $1 | awk '{print $1}' FS="/" | xargs | tr " " "," )
        command="sudo nmap -sVC -p$ports_Ofile --disable-arp-ping --min-rate=5000 -n -Pn $ip_Oaddress --stats-every=5s -oA targeted"
        echo -e "[+] command copied to clipboard, run:
$command"
        echo -e "$command" | tr -d '
' | xclip -sel clip
    fi
}
